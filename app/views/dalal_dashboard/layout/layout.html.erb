<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Dalal Dashboard</title>

    <!-- Bootstrap Core CSS -->
    <!-- <link href="app/assets/stylesheets/bootstrap.min.css" rel="stylesheet"> -->

    <!-- Custom CSS -->
    <!-- <link href="app/assets/stylesheets/dalal-admin.css" rel="stylesheet"> -->

    <!-- Custom Fonts -->
    <!-- <link href="app/assets/fonts/font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!--

    <script src="/assets/jquery.js" type="text/javascript"></script>
    <script src="/assets/jquery_ujs.js" type="text/javascript"></script>
    <script src="/assets/bootstrap.min.js" type="text/javascript"></script>
    -->
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>  
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true%>
  <%= csrf_meta_tags %>

  <!--<%= javascript_include_tag :defaults %>
  <%= csrf_meta_tag %>
  -->
</head>

<body>

 <div id="wrapper">

 <!-- Navigation -->
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <%= link_to :controller=>'dalal_dashboard', :id => current_user.id , :action=>'show' do %>
                <span class="navbar-brand" >Dalal Street</span>
                <% end %>
            </div>
            <!-- Top Menu Items -->
            <ul class="nav navbar-right top-nav">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-envelope"></i> <b class="caret"></b></a>
                    <ul class="dropdown-menu message-dropdown">
                        <% @notifications_list.each do |notice|%>
                        <li class="message-preview">
                            <a href="#">
                                <div class="media">
                                    <span class="pull-left">
                                        <img class="media-object" src="http://placehold.it/50x50" alt="">
                                    </span>
                                    <div class="media-body">
                                        <h5 class="media-heading"><strong><%= current_user.username %></strong>
                                        </h5>
                                        <p class="small text-muted"><i class="fa fa-clock-o"></i> <%= notice.updated_at%></p>
                                        <p><%= notice.notification%></p>
                                    </div>
                                </div>
                            </a>
                        </li> 
                        <% end %>
                        <li class="message-footer">
                          <a href="#notification_modal" data-toggle="modal" data-target="#notification_modal">Read All New Messages</a>
                        </li>
                    </ul>
                </li>

                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell"></i> <b class="caret"></b></a>
                    <ul class="dropdown-menu alert-dropdown">
                        <li>
                            <a href="#">Alert Name <span class="label label-default">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-primary">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-success">Alert Badge</span><Bank Loan                      </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-info">Alert Badge</Company Profile</a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-warning">Alert Badge</span></a>
                        </li>
                        <li>
                            <a href="#">Alert Name <span class="label label-danger">Alert Badge</span></a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">View All</a>
                        </li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i><%= current_user.username %><b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="#"><i class="fa fa-fw fa-user"></i> Profile</a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-fw fa-envelope"></i> Inbox</a>
                        </li>
                        <li>
                            <a href="#"><i class="fa fa-fw fa-gear"></i> Settings</a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <% if user_signed_in? %>
                            <span id="span"><i class="fa fa-fw fa-power-off"></i>
                            <%= link_to "Log out", destroy_user_session_path, :method => :delete %>
                            <% end %></span>
                        </li>
                    </ul>
                </li>
            </ul>
            <!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav side-nav">
                    <li <% if !@class_show_active.blank? %><%= @class_show_active %><% end %> >
                    <%= link_to :controller=>'dalal_dashboard', :action=>'show', :id => current_user.id  do %>
                        <span id="span"><i class="fa fa-fw fa-dashboard"></i>Dalal Panel</span>
                    <% end %>
                    </li>
                    <li <% if !@class_stock_active.blank? %><%= @class_stock_active %><% end %>  >
                    <%= link_to :controller=>'dalal_dashboard', :id => current_user.id , :action=>'stock' do %>
                        <span id="span"><i class="fa fa-fw fa-table"></i> Stock Exchange</span>
                    <% end %>
                    </li>
                    <li <% if !@class_buy_sell_active.blank? %><%= @class_buy_sell_active %><% end %> >
                    <%= link_to :controller=>'dalal_dashboard', :id => current_user.id , :action=>'buy_sell_page' do %>
                        <span id="span"><i class="fa fa-fw fa-money"></i> Buy and Sell</span>
                    <% end %>   
                    </li>
                    <li <% if !@class_bank_active.blank? %><%= @class_bank_active %><% end %> >
                    <%= link_to :controller=>'dalal_dashboard', :id => current_user.id , :action=>'bank_mortgage' do %>
                        <span id="span"><i class="fa fa-fw fa-desktop"></i> Bank Mortage</span>
                    <% end %>
                    </li>
                    <li <% if !@class_company_active.blank? %><%= @class_company_active %><% end %> >
                    <%= link_to :controller=>'dalal_dashboard', :id => current_user.id , :action=>'company' do %>
                        <span id="span"><i class="fa fa-fw fa-edit"></i> Company Profile</span>
                    <% end %>
                    </li>
                    <!-- <li>
                    <%= link_to :controller=>'dalal_dashboard', :id => current_user.id , :action=>'market_events' do %>    
                        <span id="span"><i class="fa fa-fw fa-wrench"></i> Market Events</span>
                    <% end %>
                    </li> -->
                    <li>
                        <a href="javascript:;" data-toggle="collapse" data-target="#demo"><i class="fa fa-fw fa-arrows-v"></i> Dropdown <i class="fa fa-fw fa-caret-down"></i></a>
                        <ul id="demo" class="collapse">
                            <li>
                                <a href="#">Dropdown Item</a>
                            </li>
                            <li>
                                <a href="#">Dropdown Item</a>
                            </li>
                        </ul>
                    </li>
                    <li <% if !@class_history_active.blank? %><%= @class_history_active %><% end %> >
                    <%= link_to :controller=>'dalal_dashboard', :id => current_user.id , :action=>'buy_sell_history' do %>
                        <span id="span"><i class="fa fa-fw fa-file"></i> Buy Sell History</span>
                    <% end %>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </nav>


        <div class="modal" id="marketevent_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" <% {:is_active => true} %> > 
        <div class="modal-dialog">
          <div class="modal-content contcustom">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <br>         
                <div class="modal-body" id="marketevent_modal_partial">
                <%= render partial:"dalal_dashboard/partials/marketevent_modal_partial",locals: { market_events_paginate: @market_events_paginate } %>
                </div>
              </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->


        <div class="modal" id="notification_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" <% {:is_active => true} %>> 
        <div class="modal-dialog">
          <div class="modal-content contcustom">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <br>         
                <div class="modal-body">
                <%= render partial:"dalal_dashboard/partials/notification_modal_partial",locals: {notifications_paginate: @notifications_paginate} %>
                </div>
              </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->

     <%= yield :page_wrapper %>


  </div>
    <!-- /#wrapper -->

   <%= yield :style %>

   <!-- jQuery -->
    <script src="/assets/jquery.js"></script>
    <!--<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script> -->

    <!-- Bootstrap Core JavaScript -->
    <script src="/assets/bootstrap.min.js"></script>
    <script src="/assets/jquery.newsticker.1.0.min.js"></script>
    <!--chart.js javascript -->
    <!--<script src="/assets/Chart.js"></script>-->

    <script type="text/javascript">

   $('#notification_modal').modal('hide')
    jQuery(function ($) {
        function check_values() {
           
        }
    });

   $('#marketevent_modal').modal('hide')
    jQuery(function ($) {
        function check_values() {
            
        }
    });

   window.requestAnimationFrame = (function(){
    return  window.requestAnimationFrame       ||
            window.webkitRequestAnimationFrame ||
            window.mozRequestAnimationFrame    ||
            function( callback ){
              window.setTimeout(callback, 1000 / 60);
            };
  })();

  var speed = 1000;
  (function currencySlide(){
      var currencyPairWidth = $('.slideItem:first-child').outerWidth();
      $(".modal-backdrop").remove();
      $(".slideContainer").animate({marginLeft:-currencyPairWidth},speed, 'linear', function(){
                  $(this).css({marginLeft:0}).find("li:last").after($(this).find("li:first"));
          });
          requestAnimationFrame(currencySlide);
  })();

   $( document.body ).on( 'click', '.dropdown-menu li', function( event ) {
      var $target = $( event.currentTarget );

      $target.closest( '.btn-group' )
         .find( '[data-bind="label"]' ).text( $target.text() )
            .end()
         .children( '.dropdown-toggle' ).dropdown( 'toggle' );

      return false;

   });


   // $(".pagination a").click(function() {
   //       var url = event.target+'';
   //       var num = url.split('=')[1];
   //       update_modal_partials(num);
   //  });
     $(document).ready(function () {
            $("#news1,#news2").newsticker();
        });
        
  
    var update_modal_partials = function(num){

         var data = {page: num};

         var success = function(response) {
                  console.log("Wow it worked: "+response.message);
                  //dispatcher.unbind('notification_update');
                  };

         var failure = function(response) {
                   console.log("That just totally failed: "+response.message);
                  };

         dispatcher.bind('update_modal_partials', function(company_value) {
                      console.log(company_value);
                      var rs = new RestfulWebsockets();
                      rs.refresh(show_value);
                         
      });
     
         dispatcher.trigger('update_modal_partials', data, success, failure);   

    };

    </script>

   <%= yield :script %>

</body>
</html>